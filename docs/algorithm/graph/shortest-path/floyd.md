---
title: Floyd
createTime: 2026/01/31 08:50:59
permalink: /algorithm/graph/shortest-path/floyd/
---

## 简介
Floyd 是一个最短路算法，本质是 DP。  

## 实现
令 $f_{k,i,j}$ 表示所有从 $i$ 出发，最终到达 $j$，路径上所有点编号不大于 $k$ 的最短路径长度。  
关于转移，很明显可以根据 $k$ 来划分，若不经过节点 $k$，则 $f_{k,i,j}=f_{k-1,i,j}$；若经过节点 $k$，则 $f_{k,i,j}=\min\left\{ f_{k-1,i,k}+f_{k-1,k,j} \right\}$  
但是这种做法的空间复杂度是 $O(n^3)$，并不能满足我们的要求，考虑去掉 $k$ 这一维，空间复杂度变为 $O(n^2)$（证明略）。

## 例题
### Acwing 1125. 牛的旅行 {#acwing-1125}
这道题给我们一个无向图，有多个连通块，每个连通块的直径定义为最远的两个点的最短距离。  
然后，我们需要在两个连通块间加一条边，使加完后所有连通块直径最大值最小。  
这个时候，直径的最大值有两种情况：
1.  取在某个连通块上  
    容易发现，我们加边的操作一定不会让最大值变小，即答案不小于未加边最大直径。  
2.  取在新的连通块上  
    这种时候很明显要算直径，但是加边操作并不影响原本的结构，也就是说我们可以提前处理出每个点的最远距离（直径），只需要拼接一下就可以了。  

这样做的复杂度是 $O(n^3)$，可以通过本题。  